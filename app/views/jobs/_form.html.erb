<% @cats = Contractor.categories %>
<div class="authform_large">
  <%= simple_form_for @job, wrapper: :vertical_form, 
                               html: { multipart: true, 
                                    autocomplete: 'off' },
                   wrapper_mappings: { check_boxes: :vertical_radio_and_checkboxes,
                                              file: :horizontal_file_input } do |f| %>
    <%= f.error_notification %>

    <div class="form-inputs col-md-6 col-sm-6">
      <ul class="list-inline">
        <li>
          <%= f.input :zip_code, as: :string,
                           required: true,
                        placeholder: "#{ current_user.zip_code }",
                         input_html: { maxlength: 5, id: 'form_zip_code' } %>
        </li>
        <li>
          <%= f.input :phone, as: :string,
                           label: 'Phone (optional)',
                        required: false,
                     placeholder: 'Enter a valid number' %>

        </li>
      </ul>
      <%= f.input :title, label: 'Job Title', required: true, input_html: { maxlength: 50 } %>
      
      <span class="input-group">
        <%= f.input :cost, required: true, wrapper_html: { class: 'col-xs-4' },
                              label: 'Cost Est.',
                            wrapper: :vertical_input_group do %>
            <span class="input-group-addon">$</span>
            <%= f.input_field :cost, as: :string, 
                            placeholder: '400',
                              maxlength: 5,
                                  class: 'form-control',
                                     id: 'form_zip_code' %>
        <% end %>

        <%= f.input :duration, as: :string,
                      placeholder: '6', 
                       input_html: { maxlength: 3 }, 
                     wrapper_html: { class: 'col-xs-4'} %>

        <%= f.input :duration_unit, selected: 'hours',
                                       label: 'Unit',
                                  collection: Job::DURATION_UNITS, 
                                wrapper_html: { class: 'col-xs-4 '} %>

      </span>
      <%= f.input :description, as: :text, 
                          required: true,
                             label: 'Job Description',
                       placeholder: 'Enter a brief description of this job',
                        input_html: { rows: '7', maxlength: 500 } %>

    </div>

    <div class="form-inputs col-md-6 col-sm-6">
      <div>
        <p class="text-center lead">Select between 1-3 categories</p>
        <% @cats.in_groups_of((@cats.size/2.0).ceil, false).each do |cats| %>
          <ul class="list-unstyled col-xs-6">
            <li>
              <%= f.input :categories, as: :check_boxes, 
                                label: false,
                             required: true,
                           collection: cats %>
            </li>
          </ul> 
        <% end %>
      </div>
      
      <div class="text-center">
        <%= image_tag(@job.image.url(:original)).html_safe %>
          <p>Upload an optional image for this job</p>
          <br><br>
        <% if @job.image? %>
          <%= f.input :delete_image, as: :boolean, 
                                  label: false, 
                           inline_label: 'Delete image' %><br>
        <% end %>

        <%= f.file_field :image %>
        <h4>or</h4>
        <%= f.input :image_remote_url, label: 'Paste an image URL' %>
      </div>
      <h4 class="text-center hidden text-danger" id="category_warning">
        Please pick at least one category.
      </h4>
      <%= f.button :submit, 'Post this job', class: 'user_submit' %>
    </div>      
  <% end %>
</div>